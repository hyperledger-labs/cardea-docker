# cardea-docker

A self signed SSL certificate is autogenerated at nginx/ssl/my-site.com.(key|crt). You can provide your own keys here, or modify the scripts to use an alternate key.

One method is to use Let's Encrypt:

https://letsencrypt.org/

To use the docker-compose files, we may need to install a newer version of docker-compose.

You may need to remove your previous version of docker first.

To install the lastest version of docker-compose, run.

    sudo curl -L https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose
    sudo chmod +x /usr/local/bin/docker-compose

First, checkout the repository.

    git clone ...

Then get the git submodules

    git submodule update --init

Copy dev.env or prod.env to .env and modify according to your needs

We can finally start the docker containers by runnning

    docker-compose -f docker-compose.dev.yml up

The first time you bring up the containers and agent(in a container or separate) or reset them, you must run the following script after the controller api containers have started:

    docker-compose -f docker-compose.dev.yml exec government-api npm run first-time-setup
    docker-compose -f docker-compose.dev.yml exec lab-api npm run first-time-setup
    docker-compose -f docker-compose.dev.yml exec verifier-api npm run first-time-setup

To reset all the containers, you can run:

    docker-compose -f docker-compose.dev.yml rm

To remove just one container, you can run something like the following:

    docker-compose -f docker-compose.dev.yml rm api

If you change the agent dependencies or version, you must start the docker containers with a --build flag:

    docker-compose -f docker-compose.dev.yml up --build

If you want you can run the containers detached by adding the -d command. For more details about docker-compose up, you can run

    docker-compose -f docker-compose.dev.yml up --help

If you need to execute commands in one of the running containers, you can run something like the following.

    docker-compose -f docker-compose.dev.yml exec db sh

In the previous case we entered the db container and ran the command sh. Tab completion is helpful in seeing the list of containers available.

    $ docker-compose -f docker-compose.dev.yml exec 
    api        db         ui         webserver

Follow this link to clone and install Aries Toolbox for using test agent.

    https://github.com/hyperledger/aries-toolbox/tree/23ecf6fed62eefd7b29dc1f4fbc60cd3c0bac2d5
